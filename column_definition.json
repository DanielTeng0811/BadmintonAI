{
  "metadata": {
    "description": "羽球比賽數據欄位定義",
    "players": [
      "Kento MOMOTA",
      "CHOU Tien Chen"
    ],
    "match_structure": {
      "format": "三戰兩勝制",
      "set_scoring": "21分制"
    },
    "data_recording_note": "⚠️ 資料特性：每局最後一分（決勝分）未記錄。查詢比分時，贏家分數需+1。"
  },
  "shot_types": {
    "1": {
      "name": "發短球"
    },
    "2": {
      "name": "發長球"
    },
    "3": {
      "name": "長球"
    },
    "4": {
      "name": "殺球"
    },
    "5": {
      "name": "切球"
    },
    "6": {
      "name": "挑球"
    },
    "7": {
      "name": "平球"
    },
    "8": {
      "name": "網前球"
    },
    "9": {
      "name": "推撲球"
    },
    "10": {
      "name": "接殺防守"
    },
    "11": {
      "name": "接不到"
    }
  },
  "data_columns": [
    {
      "column": "match_id",
      "description": "比賽唯一識別碼",
      "usage": "區分不同場次"
    },
    {
      "column": "set",
      "description": "局數",
      "value_range": "1-3"
    },
    {
      "column": "rally",
      "description": "該局內回合編號(每局重置)",
      "scope": "局內",
      "important_note": "跨局分析需配 match_id, set",
      "correct_usage": "總回合: df.groupby(['match_id', 'set', 'rally']).ngroups"
    },
    {
      "column": "rally_id",
      "description": "全局唯一回合ID",
      "usage": "可直接計數無需分組"
    },
    {
      "column": "ball_round",
      "description": "回合內擊球順序(從1開始)",
      "usage": "分析回合長度"
    },
    {
      "column": "player_score",
      "description": "Kento MOMOTA 分數",
      "value_range": "0-30"
    },
    {
      "column": "opponent_score",
      "description": "CHOU Tien Chen 分數",
      "value_range": "0-30"
    },
    {
      "column": "score_status",
      "description": "分數差距 (player - opponent)",
      "value_range": "正=領先, 負=落後"
    },
    {
      "column": "player",
      "description": "擊球球員姓名",
      "value_range": [
        "Kento MOMOTA",
        "CHOU Tien Chen"
      ],
      "important_note": "須用全名"
    },
    {
      "column": "server",
      "description": "發球狀態",
      "value_mapping": {
        "1": "player發球",
        "2": "對打中",
        "3": "該回合結束"
      }
    },
    {
      "column": "type",
      "description": "球種名稱(中文)",
      "value_range": [
        "殺球",
        "切球",
        "...參照shot_types"
      ],
      "note": "統計球種建議用 player_type (數字)"
    },
    {
      "column": "player_type",
      "description": "球員擊球球種代碼",
      "data_type": "float",
      "value_mapping": "1-11 (見shot_types)",
      "usage": "適合分組統計球種",
      "correct_usage": "df[df['player_type']==4].groupby('player').size()"
    },
    {
      "column": "opponent_type",
      "description": "對手上一拍球種代碼",
      "value_mapping": "1-11 (見shot_types)"
    },
    {
      "column": "hit_x",
      "description": "擊球X座標"
    },
    {
      "column": "hit_y",
      "description": "擊球Y座標",
      "note": "前排:>0.7; 中排:-0.1~0.7; 後排:<-0.1"
    },
    {
      "column": "hit_area",
      "description": "擊球區域編號 (1-32)"
    },
    {
      "column": "landing_x",
      "description": "落點X座標"
    },
    {
      "column": "landing_y",
      "description": "落點Y座標",
      "note": "前排:>0.7; 中排:-0.1~0.7; 後排:<-0.1"
    },
    {
      "column": "landing_area",
      "description": "落點區域編號 (1-32)"
    },
    {
      "column": "player_location_x",
      "description": "球員位置X"
    },
    {
      "column": "player_location_y",
      "description": "球員位置Y"
    },
    {
      "column": "player_move_x",
      "description": "球員移動目標X (預測)"
    },
    {
      "column": "player_move_y",
      "description": "球員移動目標Y (預測)"
    },
    {
      "column": "moving_x",
      "description": "球員移動後實際X"
    },
    {
      "column": "moving_y",
      "description": "球員移動後實際Y"
    },
    {
      "column": "opponent_location_x",
      "description": "對手位置X"
    },
    {
      "column": "opponent_location_y",
      "description": "對手位置Y"
    },
    {
      "column": "ball_distance",
      "description": "球員與擊球點距離"
    },
    {
      "column": "getpoint_player",
      "description": "該回合得分者",
      "scope": "僅在rally最後一拍",
      "correct_usage": "groupby(['match_id', 'set', 'rally'])['getpoint_player'].last()"
    },
    {
      "column": "win_reason",
      "description": "得分方式 (贏家觀點)",
      "scope": "回合結束時",
      "filter_condition": "getpoint_player.notna() & win_reason.notna()"
    },
    {
      "column": "lose_reason",
      "description": "失分原因 (輸家觀點)",
      "scope": "回合結束時",
      "filter_condition": "getpoint_player.notna() & lose_reason.notna()",
      "important_note": "記錄的是輸球方失誤"
    }
  ],
  "analysis_guidelines": {
    "rally_counting": {
      "issue": "rally編號每局重置",
      "correct": "df.groupby(['match_id', 'set', 'rally']).ngroups"
    },
    "win_rate_calculation": {
      "step1": "groupby(['match_id', 'set', 'rally'])['getpoint_player'].last()",
      "step2": "wins = (rally_winners == '球員').sum()",
      "step3": "win_rate = wins / len(rally_winners)"
    },
    "player_name_usage": {
      "rule": "須用完整姓名",
      "correct": [
        "Kento MOMOTA",
        "CHOU Tien Chen"
      ]
    },
    "shot_type_analysis": {
      "purpose": "球種統計",
      "correct": "用 player_type (數字) 分組",
      "note": "type=字串, player_type=代碼"
    },
    "lose_reason_filter": {
      "purpose": "查失誤原因",
      "correct": "df[(df['getpoint_player'] != '球員') & (df['lose_reason'].notna())]"
    },
    "match_score_query": {
      "context": "三戰兩勝, 21分制",
      "data_limitation": "最後一分沒記，贏家需+1",
      "correct": "找出每局最後一筆 player_score/opponent_score，贏家分數+1"
    }
  }
}